<div
    class="group bg-card hover:bg-accent/50 flex items-center gap-3 rounded-lg border p-4 transition-colors"
    [ngClass]="{ 'border-primary/50': task().isImportant, 'bg-muted/30': task().isCompleted }">
    <!-- Checkbox -->
    <button
        type="button"
        class="hover:bg-accent flex size-8 flex-shrink-0 items-center justify-center rounded-md"
        [attr.aria-label]="task().isCompleted ? 'Mark as incomplete' : 'Mark as complete'"
        (click)="toggleComplete.emit(task().id)">
        <div
            class="flex size-5 items-center justify-center rounded-full border-2 transition-colors"
            [class.bg-primary]="task().isCompleted"
            [class.border-primary]="task().isCompleted">
            @if (task().isCompleted) {
            <ng-icon
                hlm
                name="lucideCheck"
                class="text-primary-foreground"
                size="xs" />
            }
        </div>
    </button>

    <!-- Content -->
    <div class="min-w-0 flex-1">
        <h3
            class="truncate font-medium"
            [class.line-through]="task().isCompleted"
            [class.text-muted-foreground]="task().isCompleted">
            {{ task().title }}
        </h3>
        @if (task().description) {
        <p class="text-muted-foreground truncate text-sm">{{ task().description }}</p>
        } @if (task().dueDate) {
        <div
            class="mt-1 flex items-center gap-1 text-xs"
            [class.text-destructive]="isOverdue()">
            <ng-icon
                hlm
                name="lucideCalendar"
                size="xs" />
            <span>{{ formattedDate() }}</span>
        </div>
        }
    </div>

    <!-- Actions -->
    <div class="flex items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100">
        <button
            hlmBtn
            variant="ghost"
            size="icon-sm"
            [attr.aria-label]="task().isImportant ? 'Remove importance' : 'Mark as important'"
            (click)="toggleImportant.emit(task().id)">
            <ng-icon
                hlm
                name="lucideStar"
                size="sm"
                [class.fill-yellow-400]="task().isImportant"
                [class.text-yellow-400]="task().isImportant" />
        </button>
        <button
            hlmBtn
            variant="ghost"
            size="icon-sm"
            aria-label="Edit task"
            (click)="edit.emit(task())">
            <ng-icon
                hlm
                name="lucidePencil"
                size="sm" />
        </button>
        <button
            hlmBtn
            variant="ghost"
            size="icon-sm"
            aria-label="Delete task"
            class="hover:text-destructive"
            (click)="delete.emit(task().id)">
            <ng-icon
                hlm
                name="lucideTrash2"
                size="sm" />
        </button>
    </div>
</div>
